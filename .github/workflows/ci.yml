name: 🔬
on:
   push:
      branches:
         - '*'
         - '!test-ci'
      paths-ignore:
         - '**.md'
         - '.gitignore'
         - '.github/assets/**/**'
         - 'docs/**'
         - 'LICENSE'
jobs:
   latest:
      name: Ubuntu Latest
      runs-on: ${{ matrix.os }}
      strategy:
         matrix:
            os: [ubuntu-latest]
            node-version: ['19.x']
      if: ${{ !startsWith(github.event.head_commit.message, 'no-ci') }}
      steps:
         - name: ➕ Actions - Checkout
           uses: actions/checkout@v3

         - name: ➕ Actions - Setup NodeJS
           uses: actions/setup-node@v3
           with:
              node-version: ${{ matrix.node-version }}

         - name: 🏠 Create a local VPS using Docker Container
           run: docker run -d --name test-vps --privileged -p 2222:2222 -e PORT=2222 --restart always wellwelwel/vps:latest

         - name: 🏠 Preparing the Environment
           run: npm i typescript -D

         - name: ⚙️ Testing Services - Install
           run: npm run tests:install

         - name: 🧪 Testing Services - Create
           run: npm run tests:create

         - name: 🧪 Testing Services - Connection
           run: npm run tests:connection

         - name: 🧪 Testing Services - Mount
           run: npm run tests:mount

         - name: ✅ Finishing
           run: npm run tests:reset >/dev/null 2>&1 || true

   ubuntu-22:
      name: Ubuntu 22.04
      runs-on: ${{ matrix.os }}
      strategy:
         matrix:
            os: [ubuntu-latest]
            node-version: ['19.x']
      if: ${{ !startsWith(github.event.head_commit.message, 'no-ci') }}
      steps:
         - name: ➕ Actions - Checkout
           uses: actions/checkout@v3

         - name: ➕ Actions - Setup NodeJS
           uses: actions/setup-node@v3
           with:
              node-version: ${{ matrix.node-version }}

         - name: 🏠 Create a local VPS using Docker Container
           run: docker run -d --name test-vps --privileged -p 2222:2222 -e PORT=2222 --restart always wellwelwel/vps:22.04

         - name: 🏠 Preparing the Environment
           run: npm i typescript -D

         - name: ⚙️ Testing Services - Install
           run: npm run tests:install

         - name: 🧪 Testing Services - Create
           run: npm run tests:create

         - name: 🧪 Testing Services - Connection
           run: npm run tests:connection

         - name: 🧪 Testing Services - Mount
           run: npm run tests:mount

         - name: ✅ Finishing
           run: npm run tests:reset >/dev/null 2>&1 || true

   ubuntu-20:
      name: Ubuntu 20.04
      runs-on: ${{ matrix.os }}
      strategy:
         matrix:
            os: [ubuntu-latest]
            node-version: ['19.x']
      if: ${{ !startsWith(github.event.head_commit.message, 'no-ci') }}
      steps:
         - name: ➕ Actions - Checkout
           uses: actions/checkout@v3

         - name: ➕ Actions - Setup NodeJS
           uses: actions/setup-node@v3
           with:
              node-version: ${{ matrix.node-version }}

         - name: 🏠 Create a local VPS using Docker Container
           run: docker run -d --name test-vps --privileged -p 2222:2222 -e PORT=2222 --restart always wellwelwel/vps:20.04

         - name: 🏠 Preparing the Environment
           run: npm i typescript -D

         - name: ⚙️ Testing Services - Install
           run: npm run tests:install

         - name: 🧪 Testing Services - Create
           run: npm run tests:create

         - name: 🧪 Testing Services - Connection
           run: npm run tests:connection

         - name: 🧪 Testing Services - Mount
           run: npm run tests:mount

         - name: ✅ Finishing
           run: npm run tests:reset >/dev/null 2>&1 || true

   ubuntu-18:
      name: Ubuntu 18.04
      runs-on: ${{ matrix.os }}
      strategy:
         matrix:
            os: [ubuntu-latest]
            node-version: ['19.x']
      if: ${{ !startsWith(github.event.head_commit.message, 'no-ci') }}
      steps:
         - name: ➕ Actions - Checkout
           uses: actions/checkout@v3

         - name: ➕ Actions - Setup NodeJS
           uses: actions/setup-node@v3
           with:
              node-version: ${{ matrix.node-version }}

         - name: 🏠 Create a local VPS using Docker Container
           run: docker run -d --name test-vps --privileged -p 2222:2222 -e PORT=2222 --restart always wellwelwel/vps:18.04

         - name: 🏠 Preparing the Environment
           run: npm i typescript -D

         - name: ⚙️ Testing Services - Install
           run: npm run tests:install

         - name: 🧪 Testing Services - Create
           run: npm run tests:create

         - name: 🧪 Testing Services - Connection
           run: npm run tests:connection

         - name: 🧪 Testing Services - Mount
           run: npm run tests:mount

         - name: ✅ Finishing
           run: npm run tests:reset >/dev/null 2>&1 || true
